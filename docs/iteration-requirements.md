# 产品迭代需求文档（v1.1）

更新时间：2025-11-11  
适用环境：Windows 11、Node.js 18+、npm 8+、MySQL 8.0（禁止使用 Supabase）

## 0. 产品价值与定位

### 核心价值（Value Proposition）
- 降本增效：提供超过 2,000+ 的高质量 n8n 工作流模板与极速文档检索系统，显著缩短从需求到自动化落地的周期。
- 标准化与可维护：以统一 UI 标准文件与组件库为基础，减少样式分散与维护成本，保证一致性的用户体验与可读性。
- 低门槛部署：面向 Windows 11 的脚本与指引，使用 Node.js + Express 与 MySQL 8.0 的常见栈，便于团队快速落地，无需额外云依赖（禁止 Supabase）。
- 可观测与治理：内置工作流统计、分类、复杂度评估与搜索过滤，帮助团队建立自动化资产的治理与复用体系。
- 国际化支持：多语言文档与界面（中/英），适合跨区域员工使用与推广。

### 产品定位（Positioning）
- “n8n 自动化模板库 + 文档系统 + 管理台”的组合产品：既能快速检索与试用工作流模板，又能进行二次开发、分类治理与接口集成。
- 面向中小企业、技术运营团队与 n8n 创作者的工作流生产力工具，强调可复用、可度量、可扩展。

### 关键指标（示例）
- 搜索与浏览：文档系统页面访问量、搜索命中率、平均检索耗时（P95 < 300ms）。
- 转化与使用：模板导入次数、活跃工作流数量、工作流复用率、成功执行率。
- 生态与增长：GitHub Star、社区帖子互动量、渠道引流转化率（官网 → 仓库 → 导入/执行）。

### 差异化优势（与同类比较）
- 规模与分类：覆盖 365+ 集成与 2,000+ 工作流，具备细粒度的分类/复杂度/触发器标签，检索体验优于零散脚本集合。
- 设计与工程并重：先定义 UI 标准与设计令牌，再落地组件与样式，保证文档系统与管理台的长期一致性。
- Windows 友好与 MySQL 8.0 默认：降低国内团队的落地障碍，避免额外云服务锁定与合规风险。

## 1. 背景与目标

当前项目为多语言 n8n-workflows 管理系统，前后端分离（原生 HTML/CSS/JS + Node.js/Express）。现状与问题：
- 文档偏向 SQLite；本版本暂缓数据库迁移，保持现有数据库实现与访问层不变。
- 前端尚未建立统一 UI 标准文件与组件库开发流程，需要以设计令牌（Design Tokens）为基础完善全局样式与组件。
- 文档中提及 `scripts/one-click-deploy.js`，仓库未见该文件，需统一部署脚本与文档。
- i18n 存储模块（api/i18n-storage.js）未落地或未完善，需要明确接口与缓存策略。
- 测试文件（示例/临时文档）需要在测试完成后按规则及时清理。

本次迭代目标：建立 UI 标准与首批组件、完善 API 与 i18n 模块、安全与日志监控、部署脚本一致性、工作流功能增强、测试与文档同步更新，并输出可度量的验收结果（本版本不涉及数据库迁移与改造）。

## 2. 约束与规则

1) 操作系统：Windows 11 优先支持（脚本与路径兼容 PowerShell/批处理）。
2) 数据库：本版本暂不进行迁移与改造；禁止使用 Supabase。
3) 前端开发流程：必须先建立统一 UI 标准文件，再据此创建组件与全局样式；新增组件/样式时，先在 UI 标准中定义，再落实现代码。
4) 测试清理：测试完成的临时测试文档需及时删除。

## 3. 范围（Scope）

- 前端 UI 标准与全局样式：设计令牌、主题（浅/深）、响应式断点、通用布局。
- 首批组件库：Button、Tag/Badge、Input、Select、Card、Modal、Table、Pagination、Toast、LanguageSwitcher。
- API 与 i18n：完善 `/api/i18n`、`/api/workflows`、`/api/stats`、`/health`；实现 i18n 存储模块与缓存。
- 安全与日志：Helmet、CORS、Rate Limiting、输入校验；请求/错误日志与健康监控。
- 构建与部署一致性：对齐 npm scripts 与 Windows `deploy.bat`；修复文档与脚本不一致。
- 工作流功能增强：收藏、标签、复杂度评分、模板库与快速导入；搜索/过滤性能优化。
- 测试与文档：完善测试体系，执行后清理临时测试文档；更新 README/README_ZH 与 docs。

非范围（本迭代暂不涉及）：完整用户权限系统、SaaS 计费、移动端独立 App。

## 4. 详细需求与验收标准

### 4.1 数据库与存储

本版本不涉及数据库迁移或改造，保持现有实现；仅要求关键功能在当前数据库配置下稳定运行。

### 4.2 前端 UI 标准与全局样式

需求：
- 建立统一 UI 标准文件（文档：`docs/ui-standard.md`；代码：后续新增 `static/styles/ui-standard.css` 与设计令牌）。
- 设计令牌内容：颜色（主/辅/成功/警告/错误/中性色）、间距（4/8/12/16/24/32）、字号（12–24）、圆角（4/8/12）、阴影层级、z-index、动效时长、响应式断点（xs/sm/md/lg/xl）。
- 以 UI 标准为源，创建 `global.css`（布局、排版规范、主题浅/深色、无障碍对比度）。

验收标准：
- 所有组件与页面样式均引用设计令牌（CSS variables 或生成的样式），禁止散落魔法值。
- 提供浅/深色主题切换方案与示例页面，达到 WCAG 对比度要求。

### 4.3 首批组件库

需求：
- 组件：Button、Tag/Badge、Input、Select、Card、Modal、Table、Pagination、Toast、LanguageSwitcher。
- 每个组件必须：属性与状态说明、交互与无障碍规范（键盘/ARIA）、样式完全基于 UI 标准、事件命名统一（如 `onClick`、`onChange`）。

验收标准：
- 提供示例页面或 Story（可选）展示组件状态；无控制台报错；在 Windows 11 的主流浏览器正常工作。

### 4.4 API 与 i18n 模块

需求：
- 对齐并完善接口：`/api/i18n/languages`、`/api/i18n/translations/:language/:namespace`、`/api/i18n/user-language`、`/api/workflows`（分页/过滤/搜索）、`/api/stats`、`/health`。
- 实现 `api/i18n-storage.js`：命名空间与版本管理、内存/文件缓存、缺失键提示、缓存失效策略。

验收标准：
- 接口返回结构统一（含 `success`、`data`、`error` 字段）；分页与过滤参数可用；i18n 资源加载稳定。

### 4.5 安全与日志监控

需求：
- 安全：Helmet、CORS 白名单、Rate Limiting、输入校验（如 `express-validator` 或 `zod`）。
- 日志：请求/错误日志；健康检查扩展；统一 `logs/` 目录与日志轮转策略。

验收标准：
- OWASP 常见问题（XSS/CSRF/注入）有针对性防护；关键路径具备错误告警与追踪信息（trace id）。

### 4.6 构建与部署一致性（Windows 友好）

需求：
- 对齐 npm scripts 与 `scripts/deploy.bat`；完善 `deploy:prod` 流程与日志输出。
- 修复/统一文档：若无 `scripts/one-click-deploy.js`，则从文档移除或新增该脚本使之可用。

验收标准：
- Windows 11 用户可直接运行 `npm run deploy:prod` 或双击 `scripts\deploy.bat` 完成生产部署。

### 4.7 工作流功能增强与搜索优化

需求：
- 增强：收藏、标签、复杂度评分、模板库管理与快速导入。
- 搜索与过滤：关键词、触发器类型、复杂度、分页；性能优化（索引、缓存）。

验收标准：
- 数据模型与接口支持新属性；搜索响应时间在常规数据量下保持良好（P95 < 300ms，示例环境）。

### 4.8 测试与文档更新

需求：
- 建立 API 测试、组件单测与 i18n 测试；执行后清理临时测试文档（遵守“测试完即删”的项目规则）。
- 更新 README/README_ZH 与 `docs/`，以 MySQL 为默认数据库；新增迁移与部署指南；新增 UI 标准与组件使用说明。

验收标准：
- 测试通过率达设定阈值；临时测试文件清理完成；文档与代码一致且可落地。

## 5. 里程碑（4 周）

- 第1周：UI 标准与部署一致性
  - 输出：UI 标准文档初版、组件开发流程、部署脚本一致性计划。
- 第2周：组件与数据库落地
  - 输出：首批组件（Button/Tag/Input/Select/Card）、`api/i18n-storage.js` 初版。
- 第3周：功能与优化
  - 输出：Modal/Table/Pagination/Toast/LanguageSwitcher、工作流增强与搜索优化、安全中间件与日志监控、测试用例。
- 第4周：文档与发布
  - 输出：README/README_ZH/docs 更新、示例工作流包、清理测试临时文档、发布说明与推广计划联动执行。

## 6. 风险与应对

- 迁移相关风险：本版本不涉及数据库迁移，风险不在当前范围。
- 文档与代码不一致：优先修复不一致项（部署脚本），设专项验收。
- UI 标准落地难度：以设计令牌驱动组件与样式，建立审核流程防止魔法值。
- Windows 环境差异：统一使用跨平台脚本或在 `deploy.bat` 明确 PowerShell 调用约定。

## 7. 指标与验收

- 架构：关键接口错误率 < 0.5%。
- 前端：组件覆盖首批列表，样式基于令牌，无魔法值；暗/亮主题切换稳定。
- 性能：常用搜索接口 P95 < 300ms（示例数据量）。
- 安全：基础防护到位，日志与健康监控生效。
- 文档：README/README_ZH/docs 同步且可按照步骤完成部署与使用。

## 8. 附录：环境变量示例（.env.production）

```bash
NODE_ENV=production
PORT=3000
CORS_ORIGIN=https://your-domain.com
STATIC_DIR=./dist/static
DEBUG=false
```

说明：本版本数据库配置保持现状，不涉及变更与迁移，相关环境变量请参考现有实现。

## 9. 典型使用场景（Use Cases）

- 内容分发/增长运营：
  - 示例：YouTube → Telegram/Discord 定时推送；WordPress 自动发布与特色图设置；RSS → 社媒多平台分发。
  - 价值：覆盖多渠道触达，减少手工搬运，提高内容产出效率。
- 客服与工单流转：
  - 示例：Zendesk 工单触发 → Jira 任务创建 → HubSpot 同步；Webhook 响应与自动分类（Notion/Todoist）。
  - 价值：加速跨系统协作，降低人工转派与遗漏风险。
- 电商订单与通知：
  - 示例：WooCommerce/Shopify 触发 → Slack 通知/Google Sheets 归档 → D365 集成（示例仓库已有相关工作流）。
  - 价值：提高订单处理与通知的时效性与一致性。
- 数据同步与报表：
  - 示例：Notion ↔ Airtable ↔ Google Sheets 数据双向同步，定时聚合与邮件汇报（Gmail）。
  - 价值：团队统一数据视图与自动化报表，降低人工整理成本。
- 对话与消息自动化：
  - 示例：WhatsApp 触发 → 智能分类与回复；Telegram 机器人自动应答与路由。
  - 价值：提升客服/社区运营效率，减少响应等待。
- AI 与增强功能：
  - 示例：OpenAI/本地 LLM（Ollama）摘要、分类、智能命名；TOTP 生成与安全流程自动化。
  - 价值：将智能能力融入常规自动化链路，提高质量与速度。
- DevOps/备份运维：
  - 示例：n8n 工作流备份到 GitHub/Bitbucket/Nextcloud；错误上报到 Line；依赖检查与子工作流图谱。
  - 价值：保障自动化资产安全与可恢复；提升可见性与稳定性。

## 10. 目标人群（Target Users）

- n8n 创作者与自动化工程师：追求效率与复用，偏好成熟模板与可扩展接口。
- 中小企业的运营/市场/客服团队：需要低门槛的跨平台自动化与数据同步。
- IT/数据中台：希望建立统一的工作流治理、审计与复用体系（MySQL 8.0 持久化、日志与监控对齐）。
- 电商与内容团队：围绕订单、内容发布、用户触达的高频自动化场景。
- 教学与培训机构：基于模板与文档系统进行教学演示与课程编排。

## 11. 推广计划（Go-to-Market）

### 阶段与节奏（6–8 周示例）
1) 准备期（第 1–2 周）
   - 整理 30–50 个高价值场景模板（含中文说明与动图/截图）。
   - 完成 UI 标准文件与组件示例页，提升官网与文档的展示一致性。
   - 在 README_ZH/README 与 docs 中统一“Windows 11 + MySQL 8.0”默认栈，明确不使用 Supabase。
2) 发布期（第 3–4 周）
   - 渠道：GitHub（README 强化）、n8n 社区、Twitter/X、Bilibili/知乎专栏、微信群/社群。
   - 内容形式：
     - “Workflow of the Week（每周一个高价值工作流）”系列文章与短视频；
     - “2000+ 工作流检索技巧”速查指南；
     - “模板到实战”一键导入与落地案例（含脚本/指引）。
3) 增长期（第 5–8 周）
   - 开展联合直播/分享（与 n8n 社区贡献者合作），推出行业主题合集（电商/客服/内容/数据）。
   - 发布“企业实践指南”：治理/日志/备份/审计与 SSO（规划版）。

### 渠道与触达
- 开源渠道：GitHub（Star/PR/Issue 模板优化）、Awesome 列表、技术社区（n8n Community、Hacker News/Reddit）。
- 中文渠道：Bilibili、知乎、微信公众号、掘金；联合社群分享与案例征集。
- 私域与转化：提供企业试用清单与导入脚本，建立 FAQ 与使用手册；收集反馈进入迭代飞轮。

### 关键内容资产
- 用例手册：按类别/触发器/复杂度组织，提供 3–5 张示意图与落地步骤。
- 快速导入脚本与演示视频：Windows 11 下的“一键导入”与“本地运行”演示。
- 成功案例：从模板到业务指标改善的闭环故事（如触达率、响应时长、人工节省）。

### KPI（示例）
- 增长：GitHub Star +300/月、社区帖互动 30+/周、文档站 UV 10k+/月。
- 使用：模板导入 200+/月、活跃工作流 500+、成功执行率 > 98%。
- 转化：私域试用线索 50+/月；企业咨询 10+/月。

### 风险与合规
- 禁止使用 Supabase（遵循项目规则），默认推荐 MySQL 8.0；外部依赖需在文档中明确说明与替代方案。
- 测试完的临时测试文档需及时删除，避免混淆与信息泄漏。