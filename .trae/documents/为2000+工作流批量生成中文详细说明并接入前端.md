## 目标与交付物
- 为所有工作流补充中文“详细介绍、流程说明、所用工具、需配置的参数、主要使用场景”等结构化内容
- 产出 `docs/api/workflow-docs.json`（或按工作流分文件）供前端展示，支持懒加载
- 将生成流程加入一键部署，保证索引与文档同步更新

## 现状与可复用能力
- 工作流存储：`workflows/` 下分服务目录，均为 n8n 导出 JSON
- 索引器：`src/database.js` 解析节点/触发/集成并入库（分析入口 src/database.js:171，触发与集成解析 src/database.js:241，描述生成 src/database.js:274）
- 前端列表：`docs/js/search.js` 使用 `docs/api/search-index.json` 展示卡片与详情弹窗（详情弹窗入口 docs/js/search.js:246）
- 文档生成器：`tools/workflow_documentation_generator.py` 已能生成英文化的 API/使用/部署/排障四类 Markdown（完整生成入口 tools/workflow_documentation_generator.py:610）
- 一键部署：`scripts/one-click-deploy.js`，可在构建与数据库初始化后挂接文档与索引任务（启动流程 scripts/one-click-deploy.js:153）

## 文档数据结构（建议）
- 新增聚合文件：`docs/api/workflow-docs.json`
- 每项字段：
  - `id`、`filename`、`category`、`integrations`、`node_count`
  - `overview_zh`：详细介绍（中文）
  - `flow_zh`：流程说明（中文，含触发→主要处理→输出）
  - `tools_zh`：所用工具（集成/节点类型中文名）
  - `parameters_zh`：需配置的关键参数（按节点归类，列出必填/建议项）
  - `credentials_zh`、`env_vars`、`webhooks`（路径/方法）
  - `scenarios_zh`：主要使用场景与最佳实践
- 保持与 `search-index.json` 解耦，前端详情弹窗按需请求该文件，避免一次加载2000+条

## 生成策略
- 自动提取：基于工作流 JSON 的 `nodes/parameters/credentials/connections`
  - 节点/集成枚举、Webhook 路径/方法、环境变量（`{{ $env.* }}`）与凭据类型
  - 以连接图拓扑排序输出“触发→处理→集成/输出”的流程文字
- 中文内容：
  - 标题/简介复用 `static/locales/zh/translation.json` 的现有汉化（示例 static/locales/zh/translation.json:177 起）
  - 其余段落由模板+规则术语表生成中文（保持技术名词/参数键用反引号保留英文）
- 生成器实现：复用并扩展 `tools/workflow_documentation_generator.py` 输出 JSON（除现有 Markdown 外增加 JSON 聚合写入 docs/api/workflow-docs.json）

## 前端改造
- `docs/js/search.js`：
  - 在 `openWorkflowDetails`（docs/js/search.js:233）中懒加载 `workflow-docs.json`
  - 详情弹窗（docs/js/search.js:246）改为 Tab：
    - “详介”显示 `overview_zh`
    - “流程”显示 `flow_zh`
    - “工具/参数”显示 `tools_zh` 与 `parameters_zh`
    - “场景”显示 `scenarios_zh`，附常见陷阱/建议
  - 缺省回退：若某字段缺失，显示索引器的通用描述与基础元数据

## 部署集成
- 在一键部署中，于“数据库初始化”后追加：
  - 调用 Python 生成器：`python tools/workflow_documentation_generator.py`（生成 Markdown 与 JSON）
  - 调用索引导出：`python scripts/generate_search_index.py`（确保 stats 与列表同步）
- 相关入口：scripts/one-click-deploy.js 可在 `initDatabase()` 之后插入命令（scripts/one-click-deploy.js:81 以后）

## 校验与质量
- 统计覆盖率：生成后输出覆盖率与缺失项列表（总数、缺字段、空值），写入 `reports/workflow_i18n_completion_report.md`
- 抽样验证：随机抽取每类复杂度各20条比对文档与 JSON 实际节点
- 性能：前端只在详情弹窗加载单条文档，避免首次渲染压力

## 里程碑
- 第1步：扩展生成器并产出 `workflow-docs.json`（含中文模板）
- 第2步：前端接入详情 Tab 与懒加载
- 第3步：一键部署串联生成与索引
- 第4步：覆盖率提升与抽样校验、优化术语表

## 风险与回退
- 个别工作流结构不规范：提供容错与通用模板回退
- 中文术语一致性：集中术语表维护；参数名保留英文避免误译
- 文件体积：如过大，改为按工作流分文件 `docs/workflows/<id>.json` 并动态请求